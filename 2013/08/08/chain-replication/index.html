<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Chain Replication</title>
  <meta name="description" content="ChainReplicationis a paper from ‘04 by Renesse and Schneider. The system is interesting,because it is a primary-backup system with an unconventionalarchitect...">

  <base href="/" />
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://dsrg.pdos.csail.mit.edu/2013/08/08/chain-replication/">
  <link rel="alternate" type="application/rss+xml" title="Distributed Systems Reading Group" href="http://dsrg.pdos.csail.mit.edu/feed.xml" />
  <link href='/stylesheets/all-b5d41f4fa671ec94597e984da68527b0.css' media='all' rel='stylesheet' type='text/css'>
  <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>

  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Distributed Systems Reading Group</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/about/">About</a>
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="/papers/">Papers</a>
          
        
          
          <a class="page-link" href="/schedule/">Schedule</a>
          
        
      </div>
    </nav>

  </div>

</header>

    <div class="page-content">
      <div class="wrapper">
        <aside class="recent-posts">
  <h2>Recent posts</h2>
  <ul>
      
        <li>
          <span class="post-meta">Jan 10, 2014</span>
          <h2>
            <a class="post-link" href="/2014/01/10/epaxos/">EPaxos</a>
          </h2>
        </li>
      
        <li>
          <span class="post-meta">Dec 16, 2013</span>
          <h2>
            <a class="post-link" href="/2013/12/16/sinfonia/">Sinfonia</a>
          </h2>
        </li>
      
        <li>
          <span class="post-meta">Sep 30, 2013</span>
          <h2>
            <a class="post-link" href="/2013/09/30/spark-streaming/">Discretized Streams</a>
          </h2>
        </li>
      
        <li>
          <span class="post-meta">Sep 30, 2013</span>
          <h2>
            <a class="post-link" href="/2013/09/30/spanstore/">SPANStore</a>
          </h2>
        </li>
      
        <li>
          <span class="post-meta">Aug 8, 2013</span>
          <h2>
            <a class="post-link" href="/2013/08/08/chain-replication/">Chain Replication</a>
          </h2>
        </li>
      
        <li>
          <span class="post-meta">Jul 25, 2013</span>
          <h2>
            <a class="post-link" href="/2013/07/25/mdcc/">MDCC</a>
          </h2>
        </li>
      
        <li>
          <span class="post-meta">Jul 18, 2013</span>
          <h2>
            <a class="post-link" href="/2013/07/18/coralcdn/">CoralCDN</a>
          </h2>
        </li>
      
        <li>
          <span class="post-meta">Jul 11, 2013</span>
          <h2>
            <a class="post-link" href="/2013/07/11/zookeeper/">Zookeeper</a>
          </h2>
        </li>
      
        <li>
          <span class="post-meta">Jul 3, 2013</span>
          <h2>
            <a class="post-link" href="/2013/07/03/thialfi/">Thialfi</a>
          </h2>
        </li>
      
        <li>
          <span class="post-meta">Jun 20, 2013</span>
          <h2>
            <a class="post-link" href="/2013/06/20/vr-revisited/">VR Revisited</a>
          </h2>
        </li>
      
  </ul>
</aside>
<div class="post">

  <header class="post-header">
    <h1 class="post-title">Chain Replication</h1>
    <p class="post-meta">Aug 8, 2013</p>
  </header>

  <article class="post-content">
    <p><a href="http://db2.usenix.org/events/osdi04/tech/full_papers/renesse/renesse.pdf">Chain
Replication</a>
is a paper from ‘04 by Renesse and Schneider. The system is interesting,
because it is a primary-backup system with an unconventional
architecture that aimed to achieve high throughput and availability
while maintaining strong consistency.</p>

<h2 id="what-is-chain-replication">What is Chain Replication</h2>

<p>Chain replication is a special primary backup system, in which the
servers are linearly ordered to form a chain with the primary at the
end. In “classic” primary backup systems, the topology resembles a star
with the primary at the center.  The goal of this design is, in the
authors’ own words, “to achieve high throughput and availability without
sacrificing strong consistency”.</p>

<h2 id="the-chain-replication-protocol">The Chain replication protocol</h2>

<p>The chain replication protocol is quite simple: All read requests are
sent to the tail (primary) of the chain as in normal primary-backup
systems, all write requests are sent to the head (a backup), which then
passes the update along the chain. To avoid unnecessary work, only the
result of the write is passed down the chain. Strong consistency
naturally follows, because all requests are ordered by the primary at
the tail of the chain.</p>

<p>The protocol considers only three failure cases, all of which are
fail-stop failures:</p>

<ol>
  <li>Fail-stop of the head</li>
  <li>Fail-stop of the tail (primary)</li>
  <li>Fail-stop of a middle server</li>
</ol>

<p>Failures are detected by a Paxos-service. The simplest failure is
fail-stop of the head, where the next server in the chain takes over as
head. Failure of the tail is equally simple.</p>

<p>To cope with a middle server failure, servers need to keep a history of
requests that they have processed. If a middle server fails, its two
neighbors bypass it and connect. The later server sends the other one
the list of requests it has seen, so that the other server can forward
any requests that were dropped when the middle server failed. To keep
the size of this history short, the tail of the chain acks requests and
the ack is passed up the chain.</p>

<p>The protocol also allows for chains to be extended. This is done by
copying the state of the tail to a new server and then making the new
server the tail.</p>

<h2 id="performance-evaluation">Performance evaluation</h2>

<p>Renesse and Schneider compare their protocol with ordinary primary
backup. While they admit that detecting a failed server will take much
longer than fixing the failure once it’s detected, they discuss at
length how many message round-trips the recovery will take in both
systems. Which system performs better actually depends on the mix of
reads vs. writes, because while primary failure is easier to fix in
chain replication, backup failure is easier to fix under a classic
primary-backup scheme.</p>

<p>A big part of the paper consists of evaluating the performance of chain
replication with different setups under multiple load scenarios. The
interesting take-away for systems with a single chain is that weak chain
replication (where one can read (possibly stale) data from any server in
the chain) may actually perform worse than strong chain replication with
a ratio of updates to writes as small as <script type="math/tex">\frac{1}{10}</script>. They explain
this with the fact that processing reads uses resources at the head that
could otherwise be used for updates.</p>

<p>Renesse and Schneider also evaluate the performance of their system when
the data is spread in <em>volumes</em> across multiple chains. The interesting
thing to note there is that read throughput is permanently lowered after
a failure, even when a new server is added to the system, because that
new server will become the tail of all the chains that the failed server
was involved in. Also interesting to note is that work throughput
increases temporarily after a failure, because the shorter length of
chains means that less work has to be done for each write until the
failed server is replaced.</p>

<h2 id="discussion">Discussion</h2>

<p>It was interesting to read a paper about a different kind of
primary-backup system, and the simplicity of chain-replication was quite
surprising. While the system is interesting from a conceptual point of
view, it doesn’t seem very suitable for any real-world scenarios.
Firstly, the system is designed to operate with equal latency between
all nodes and thus doesn’t scale beyond a LAN. Secondly, the authors
assume uniform popularity of stored items. The current system would
perform very poorly if a few items were the target of the majority of
the requests, because replication is not used to spread the load.</p>

<p>The system still has some potential for improvement. As the experiments
clearly show, performance decreases with every failure. This could
easily be fixed by allowing for servers to be added not only as tail,
but also as head or middle server.</p>

  </article>

</div>


        
          <div id="disqus_thread"></div>
          <script type="text/javascript">
              var disqus_shortname = 'dsrg';
              var disqus_url = 'http://dsrg.pdos.csail.mit.edu/2013/08/08/chain-replication/';
              (function() {
                  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
              })();
          </script>
          <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
        
      </div>
    </div>

    <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-968607-14']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

  </body>

</html>
